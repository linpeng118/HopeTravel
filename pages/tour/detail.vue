<template>
 <div class="tour-page">
   <div class="tour-head"></div>
   <div class="box-con">
     <div class="tour-jianjie">
       <p class="p0">
         <span><img src="../../assets/imgs/tour/video.png" alt="">5</span>
         <span><img src="../../assets/imgs/tour/img.png" alt="">1233</span>
       </p>
       <div>
         <p class="p1">青城山青青城山青城山青城山青城山青城山青城山青城山青城山青城山青城山青城山青城山青城山青城山青城山青城山城山青城山青城山青城山青城山青城山青城山</p>
         <p class="p2">
           <span class="span1">
            <img src="../../assets/imgs/tour/star.png" alt="">5.0
           </span>
           <span class="span2"> （2415条评价）</span>
         </p>
         <p class="p3">
           <span class="span1"><img src="../../assets/imgs/tour/add.png" alt=""></span>
           <span class="span2">四川省都江堰市青城镇都江堰西南15KM
            <i class="span3"><img src="../../assets/imgs/tour/right2.png" alt=""></i>
           </span>
         </p>
         <p class="p3">
           <span class="span1"><img src="../../assets/imgs/tour/time.png" alt=""></span>
           <span class="span2">营业时间：夏季9:00-21:00；冬季9:0营业时间：夏季9:00-21:00；冬季9:0</span>
         </p>
         <p class="p3">
           <span class="span1"><img src="../../assets/imgs/tour/play.png" alt=""></span>
           <span class="span21">建议游玩时间：6小时
           <i class="span4">￥40元/起 <a href="" style="color: red">&nbsp;&nbsp;购票</a></i>
           </span>
         </p>
       </div>
     </div>
     <!--攻略-->
     <div class="tourtitle">
       <span class="span1">玩法攻略</span>
       <span class="span2">（40篇）</span>
       <span class="span3">查看更多<img src="../../assets/imgs/tour/right.png" alt=""></span>
     </div>
     <div class="tour-gonglve">
       <div class="gonglvebox">
         <div class="gonglve-item">
           <div class="imgbox"><img src="../../assets/imgs/tour/play.png" alt=""></div>
           <p class="p1">111111111111</p>
           <p class="p2">22222222</p>
         </div>
         <div class="gonglve-item">
           <div class="imgbox"><img src="../../assets/imgs/tour/play.png" alt=""></div>
           <p class="p1">111111111111</p>
           <p class="p2">22222222</p>
         </div>
         <div class="gonglve-item">
           <div class="imgbox"><img src="../../assets/imgs/tour/play.png" alt=""></div>
           <p class="p1">111111111111</p>
           <p class="p2">22222222</p>
         </div>
       </div>
     </div>
     <!--门票-->
     <div class="tourtitle">
       <span class="span1">景点门票</span>
       <span class="span2">（12项）</span>
       <span class="span3">查看更多<img src="../../assets/imgs/tour/right.png" alt=""></span>
     </div>
     <div class="tour-menpiao">
       <div class="menpiao-item">
         <p class="p1"><i class="ziyin">自营</i>
           <span class="span1">成人票</span>
           <span class="span2">（需要身份证）</span>
           <span class="span3">￥80</span>
          </p>
         <p class="p2">
           <span class="tejia">特价</span>
           <span class="tejia">折扣</span>
           <span class="youhui">￥500-50</span>
           <span class="buybtn">购票</span>
         </p>
       </div>
       <div class="menpiao-item" style="border: none">
         <p class="p1"><i class="ziyin">自营</i>
           <span class="span1">成人票</span>
           <span class="span2">（需要身份证）</span>
           <span class="span3">￥80</span>
         </p>
         <p class="p2">
           <span class="tejia">特价</span>
           <span class="tejia">折扣</span>
           <span class="youhui">￥500-50</span>
           <span class="buybtn">购票</span>
         </p>
       </div>
     </div>
     <!--行程-->
     <div class="tourtitle">
       <span class="span1">相关行程</span>
       <span class="span3">查看更多<img src="../../assets/imgs/tour/right.png" alt=""></span>
     </div>
     <div class="tour-xingcheng">
       <div class="product-item" target="_blank">
         <div class="box-img">
           <img src="../../assets/imgs/tour/star.png" alt="">
         </div>
         <div class="con">
           <!--<div class="p1" v-html="data.name.length>30?data.name.substr(0,26)+'...':data.name"></div>-->
           <div class="p1" >namenamenamenamenamenamenamenamenamenamename</div>
           <div class="p0">
             <span>￥500-50</span>
           </div>
           <p class="p2">
             <span class="span1">
               ¥ 12474
                <i>起&nbsp;</i>
                <i style="text-decoration:line-through">￥15000</i>
             </span>
             <span class="span2"><img src="../../assets/imgs/tour/star.png" alt="">5.0分</span>
           </p>
         </div>
         <p class="p3">
           <span class="span1">热销行程</span>
           <span class="span1">低价保证</span>
           <span class="span2">1424人出行</span>
         </p>
       </div>
       <div class="product-item" target="_blank">
         <div class="box-img">
           <img src="../../assets/imgs/tour/star.png" alt="">
         </div>
         <div class="con">
           <!--<div class="p1" v-html="data.name.length>30?data.name.substr(0,26)+'...':data.name"></div>-->
           <div class="p1" >namenamenamenamenamenamenamenamenamenamename</div>
           <div class="p0">
             <span>￥500-50</span>
           </div>
           <p class="p2">
             <span class="span1">
               ¥ 12474
                <i>起&nbsp;</i>
                <i style="text-decoration:line-through">￥15000</i>
             </span>
             <span class="span2"><img src="../../assets/imgs/tour/star.png" alt="">5.0分</span>
           </p>
         </div>
         <p class="p3">
           <span class="span1">热销行程</span>
           <span class="span1">低价保证</span>
           <span class="span2">1424人出行</span>
         </p>
       </div>
     </div>
     <!--评论-->
     <div class="tourtitle">
       <span class="span1">评论</span>
       <span class="span3">查看更多<img src="../../assets/imgs/tour/right.png" alt=""></span>
     </div>
     <div class="tour-pinglun">
        <img class="img2" src="../../assets/imgs/tour/star.png" alt="">
         <div class="itemcom">
           <p>item.user_name</p>
           <p><span>2019-13-852019-13-852019-13-85</span></p>
           <p>这个地方看起来特别漂亮，这个地方看起来特别漂亮，这个地方看起来特别漂亮，这个地方看起来特别漂亮这个地方看起来特别漂亮</p>
           <p class="imgb">
             <img src="../../assets/imgs/tour/play.png" alt="">
             <img src="../../assets/imgs/tour/play.png" alt="">
             <img src="../../assets/imgs/tour/play.png" alt="">
           </p>
           <p class="icon">
             <img src="../../assets/imgs/tour/imgcion.png" alt="">
             <span class="span1"> 共9张</span>
           </p>
         </div>

     </div>
     <!--附近景点-->
     <div class="tourtitle">
       <span class="span1">附近景点</span>
       <span class="span3">查看更多<img src="../../assets/imgs/tour/right.png" alt=""></span>
     </div>
     <div class="tour-local">
       <div class="touritem">
         <div class="imgb2"><img src="../../assets/imgs/tour/imgcion.png" alt=""></div>
         <div class="con">
           <p class="p1">
             青城山
             <span class="span1"><img src="../../assets/imgs/tour/add.png" alt="">30km</span>
           </p>
           <p class="p2">问水都江堰，拜道青城山</p>
           <p class="p3">门票：￥60</p>
         </div>
       </div>
     </div>
   </div>


 </div>
</template>

<script>
  import vueWaterfallEasy from 'vue-waterfall-easy'
  let goToBackPage = '/tour/list' // 记录下来当前的页面
  export default {
    layout: 'default',
    head() {
      return {
        title: this.product?this.product.name:'景区详情',
        meta: [
          {name: 'description', content:this.product?this.product.name:'', 'hid': 'description'},
        ]
      }
    },
    components: {
      vueWaterfallEasy
    },
    async asyncData({$axios, query, store, req}) {
      let tourId,
        product
      if (String(query.tourId).indexOf('-') >= 0) {
        tourId = Number(query.tourId.toString().split('-')[0])
      } else {
        tourId = Number(query.tourId)
      }
      try {
        let {
          code,
          msg,
          data
        } = await $axios.$get(`/api/product/${tourId}`, {
          headers: {
            'Platform': store.state.platform,
            'Phone-Type': store.state.phoneType,
            'App-Version': store.state.phoneType,
            'Language': store.getters.language,
          }
        })
        if (code === 0) {

          product = data.product // 产品信息
        } else {
          console.log('error:', msg)
        }
      } catch (error) {
        console.log('detail-error', error)
      }
      return {

        product,
      }
    },
    data() {
      return {
        loading: false,
        isTransparent: false, // 导航头是否透明
      }
    },
    beforeRouteEnter (to, from, next) {
      next(vm => {
        goToBackPage = from.fullPath
      })
    },
    computed: {

    },
    watch: {

    },
    async mounted() {

    },
    methods: {

      async init() {
        if (!(this.product && this.product.product_id)) {
          this.jumpTo('/')
        }
        // 是否有登录态
        await this.initProfileData()

      },
      // 获取profile-登录态
      async initProfileData() {
        setTimeout(() => {
          // console.log(4444, this.profile.is_agent, String(this.$route.query.productId).indexOf('-') <= 0)
          if (this.profile.is_agent && String(this.$route.query.productId).indexOf('-') <= 0) {
            this.$router.push({
              name: 'product-detail',
              query: {
                productId: String(this.$route.query.productId) + '-' + this.profile.customer_id
              }
            })
          }
        }, 50)
        // console.log(this.$route)
      },
      // 跳转至注册页
      toRegist() {
        this.jumpTo('/login/regist')
      },
      /**
       * 年月日转周几
       * @params year
       * @params month
       * @params day
       */
      getWeek(year, month, day) {
        let date = `${year}/${month}/${day}`
        let week = new Date(date).getDay()
        switch (week) {
          case 0:
            return this.$t('weekend')
            break;
          case 1:
            return this.$t('monday')
            break;
          case 2:
            return this.$t('tuesday')
            break;
          case 3:
            return this.$t('wednesday')
            break;
          case 4:
            return this.$t('thursday')
            break;
          case 5:
            return this.$t('friday')
            break;
          case 6:
            return this.$t('saturday')
            break;
          default:
            // console.log(`${week} is not found`)
            break;
        }
      },
      onCopy(e) {
        this.$toast(this.$t('shareComp.copySuccess'))
      },
      // 复制失败
      onError(e) {
        this.$toast(this.$t('shareComp.copyFail'))
      },
      onHeaderLeft() {
        this.$router.push(goToBackPage)
      },
      // 返回首页
      onHomePage() {
        this.jumpTo('/')
      },
      jumpTo(path) {
        this.$router.push({
          path
        })
      },
    },
  }

</script>


<style lang="scss" scoped>
  .tour-page{
    background-color:#f3f3f3 ;
    padding-bottom: 52px;
    overflow-x: hidden;
  }
  .tour-head{
    width: 750px;
    height: 640px;
    background-color: #aaa;
  }
  .box-con{
    padding: 32px;
    .tour-jianjie{
      width: 100%;
      margin-top: -220px;
      .p0{
        height: 68px;
        padding: 10px 0;
        span{
          float: right;
          display: inline-block;
          height: 50px;
          line-height: 50px;
          font-size: 28px;
          color: #fff;
          padding-left: 10px;
          img{
            width: 48px;
            height: auto;
            float: left;
          }
        }
      }
      div{
        width:100%;
        box-sizing: border-box;
        padding: 24px;
        background-color: #fff;
        border-radius:12px;
        .p1{
          color: #1D1D1D;
          font-size: 44px;
          line-height: 60px;
        }
        .p2{
          .span1{
            line-height: 34px;
            font-size: 24px;
            color:#FFBE0D;
            img{
              width: 20px;
            }
          }
          .span2{
            line-height: 34px;
            font-size: 24px;
            color: #5e5e5e;
          }
        }
        .p3{
          padding-bottom: 1px ;
          .span1{
           float: left;
            img{width: 28px;height: 28px}
          }
          .span2{
            display: inline-block;
            line-height: 71px;
            color: #cecece;
            margin-left: 5px;
            font-size:28px;
            border-bottom: 1px solid #cecece;
            width: 590px;
            overflow: hidden;
            text-overflow:ellipsis;
            white-space: nowrap;
            padding-bottom: 10px;
          }
          .span21{
            display: inline-block;
            line-height: 72px;
            margin-left: 5px;
            color: #cecece;
            font-size:28px;
            width: 590px;
          }
          .span3{
            img{width: 28px;height: 28px;float: right;position: relative;top: 20px}
          }
          .span4{
            font-size:24px;
            font-weight:bold;
            color:rgba(29,29,29,1);
            float: right;
            line-height: 72px;
            font-style: normal;
          }
        }
      }
    }
    .tourtitle{
      width: 100%;
      padding: 16px 0;
      margin-top: 34px;
      height: 82px;
      .span1{
        display: inline-block;
        line-height: 50px;
        color: #1d1d1d;
        font-weight: bolder;
        font-size: 36px;
        float: left;
      }
      .span2{
        display: inline-block;
        line-height: 50px;
        color:#9E9E9E;
        font-size: 28px;
        float: left;
        margin-left:15px;
      }
      .span3{
        display: inline-block;
        line-height: 50px;
        color:#4DC02A;
        font-size: 24px;
        float: right;
        img{
          width:28px;
          height: 28px;
          position: relative;
          top: 5.5px;
        }
      }
    }
    .tour-gonglve{
      width: 100%;
      height: 280px;
        .gonglvebox{
          width: 1060px;
          height: 280px;
          overflow:auto;
          .gonglve-item{
            width:334px;
            border-radius: 12px;
            height:280px;
            margin-right: 16px;
            background-color: #fff;
            float: left;
            .imgbox{
              width:334px;
              height: 188px;
            }
            .p1{
              color: #1D1D1D;
              font-size:28px;
              padding-left: 16px;
              line-height: 40px;
            }
            .p2{
              color: #9E9E9E;
              font-size:24px;
              padding-left: 16px;
              line-height: 34px;
            }
          }
        }

    }
    .tour-menpiao{
      width: 100%;
      height: 238px;
      background-color: #fff;
      border-radius: 12px;
      padding:0 16px 16px 16px;
      .menpiao-item{
        padding: 0 16px 16px 16px;
        border-bottom:1px solid rgba(206,206,206,1);
        i{
          font-style: normal;
        }
        .ziyin{
          width:58px;
          display: inline-block;
          height:32px;
          background:rgba(255,190,13,1);
          opacity:1;
          border-radius:8px;
          line-height: 32px;
          font-size: 20px;
          color: #fff;
          text-align: center;
        }
        .tejia{
          width:58px;
          display: inline-block;
          height:32px;
          background:#FF3434;
          opacity:1;
          border-radius:8px;
          font-size: 20px;
          line-height: 32px;
          color: #fff;
          text-align: center;
        }
        .youhui{
          height:32px;
          opacity:1;
          border-radius:8px;
          font-size: 20px;
          line-height: 32px;
          color:#FF3434;
          display: inline-block;
          text-align: center;
          border: 1px solid #FF3434;
        }
        .buybtn{
          width:72px;
          height:34px;
          display: inline-block;
          color: #fff;
          text-align: center;
          line-height: 34px;
          background:rgba(255,52,52,1);
          border:2px solid rgba(255,52,52,1);
          opacity:1;
          font-size: 24px;
          position: relative;
          top: 10px;
          border-radius:24px;
          float: right;
        }
        .p1{

          .span1{
            font-size:28px;
            font-weight:bold;
            line-height:40px;
            display: inline-block;
            color:rgba(29,29,29,1);
          }
          .span2{
            font-size:28px;
            line-height:40px;
            display: inline-block;
            color:#9E9E9E;
          }
          .span3{
            font-size:32px;
            font-weight:bold;
            line-height:44px;
            color:rgba(255,52,52,1);
            opacity:1;
            float: right;
            position: relative;
            top: 10px;
          }
        }
        .p2{
          line-height: 40px;
        }
      }

    }
    .tour-xingcheng{
      width: 100%;
      .product-item{
        width:750px;
        height:320px ;
        padding-top: 10px;
        box-sizing: border-box;
        .box-img{
          width: 240px;
          display: inline-block;
          height: 240px;
          border-radius:12px;
          overflow: hidden;
          position: absolute;
          background-color: #dedede;
          box-shadow:0px 0px 12px rgba(52,52,52,0.2);
          img{
            height: 240px;
          }
        }
        .con{
          padding:20px 28px 20px 180px ;
          margin-top: 56px;
          width: 620px;
          height: 240px;
          box-sizing: border-box;
          background:rgba(255,255,255,1);
          box-shadow:0px 0px 28px rgba(52,52,52,0.2);
          border-radius: 12px;
          margin-left: 60px;
          .p1{
            width: 418px;
            font-size: 28px!important;
            color: #2d2d2d;
            line-height: 36px;
            padding-left: 20px;
            height: 80px;
            white-space:normal; word-break:break-all;
          }
          .p0{
            padding-left: 20px;
            margin-top: -20px;
            span{
              height:36px;
              line-height: 36px;
              background:rgba(255,255,255,1);
              border:2px solid rgba(255,52,52,1);
              font-size:20px;
              color: #FF3434;
              display: inline-block;
              border-radius: 8px;
              margin-right: 10px;
              padding: 0 10px;;
            }
          }
          .p2{
            width: 418px;
            height: 48px;
            font-size: 24px;
            color: #d4d4d4;
            padding-left: 10px;
            line-height: 48px;
            .span1{
              font-size:36px;
              font-weight:bold;
              line-height:44px;
              color:rgba(255,52,52,1);
              opacity:1;
              i{
                font-style: normal;
                font-size: 20px;
                color:rgba(158,158,158,1);
                line-height:28px;
              }
            }
            .span2{
              float: right;
              margin-left: 12px;
              line-height: 34px;
              font-size: 24px;
              color:#FFBE0D;
              img{
                width: 34px;
                height: 34px;
                position: relative;
                top: 8px;
              }
            }
          }
        }
        .p3{
          width: 558px;
          height: 48px;
          font-size: 24px;
          color: #d4d4d4;
          margin-top: -48px;
          margin-left: 100px;
          .span1{
            line-height: 36px;
            display: inline-block;
            color: #9E9E9E;
          }
          .span2{
            float: right;
            line-height: 36px;
            display: inline-block;
            color: #9E9E9E;
          }


        }

      }
    }
    .tour-pinglun{
      width: 100%;
      padding: 20px 12px;
      background-color: #fff;
      .itemcom{
        width: 575px;
        display: inline-block;
        margin-left: 70px;
        border-bottom:1px solid #CECECE ;
        p:nth-child(1){
          color: #1D1D1D;
          font-size: 28px;
          line-height: 50px;
        }
        p:nth-child(2){
          span{
            font-size: 20px;
            color: #d9d9d9;
          }
        }
        p:nth-child(3){
          font-size: 28px;
          color:#1D1D1D;
        }
        .imgb{
          width: 100%;
          height:138px;
          img{
            width:182px;
            height: 138px;
            float: left;
            margin-right: 5px;
          }
        }
        .icon{
          img{
            width: 48px;
            height: 48px;
          }
          .span1{
            font-size:20px ;
            line-height: 48px;
            color: #9e9e9e;
            height: 48px;
            display: inline-block;
            position: relative;
            top: -14px;
          }
        }

      }
      .img2{
        width: 60px;
        height: 60px;
        display: inline-block;
        background-color: #f2f2f2;
        position: absolute;
        border-radius: 60px;
        float: left;
      }
    }
    .tour-local {
      width: 100%;
      .touritem{
        padding: 20px;
        box-sizing: border-box;
        width: 100%;
        height:168px ;
        border-radius: 12px;
        background-color: #fff;
        .imgb2{
          width: 170px;
          height: 128px;
          float: left;
        img{
            width: 170px;
            height: 128px
          };
        }
        .con{
          margin-left: 18px;
          .p1{
            font-size:36px;
            font-weight:bold;
            line-height:50px;
            color:rgba(29,29,29,1);
            .span1{
              font-size:24px;
              font-weight:400;
              line-height:34px;
              color:rgba(255,190,13,1);
              img{
                width: 28px;
                height: 28px;
                position: relative;
                top: 5px;
              }
            }
          }
          .p2{
            font-size:24px;
            font-weight:400;
            line-height:50px;
            color:rgba(29,29,29,1);
            opacity:1;
          }
          .p3{
            font-size:24px;
            font-weight:500;
            line-height:36px;
            color:rgba(158,158,158,1);
          }
        }

      }
    }
  }
  </style>
